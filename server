#!/bin/bash

if $(node -v | grep -Eq ^v4 ); then
    echo "Node installed"
else
    $(sudo apt-get install nodejs)
fi

if $(npm -v | grep -Eq ^2); then
    echo "NPM installed...now check packages"
else
    $(sudo apt-get install npm)
fi

if $(ls node_modules | grep json-duplex-stream >/dev/null 2>&1); then
         echo "modules installed"
else
        $(npm install json-duplex-stream)
        $(npm install stream-meter)
        $(npm install yargs)
        $(npm install bnf)
fi

password=admin

if [ "$#" = 1 ]; then
     port="$1"
fi

if [ "$2"]; then
   password="$2"
fi

echo "$passwordnode"
$(node server.js test $port $password)
